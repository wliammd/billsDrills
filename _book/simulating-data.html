<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Simulating data | Bill’s Drills Book</title>
  <meta name="description" content="Chapter 11 Simulating data | Bill’s Drills Book" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Simulating data | Bill’s Drills Book" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="https://github.com/wliammd/billsDrills" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Simulating data | Bill’s Drills Book" />
  
  
  

<meta name="author" content="William McDonald" />


<meta name="date" content="2020-09-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="subset.html"/>
<link rel="next" href="functions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bill's Drills Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Drills: Part of Every Healthy Intellectual Diet</a></li>
<li class="chapter" data-level="2" data-path="bookdownplan.html"><a href="bookdownplan.html"><i class="fa fa-check"></i><b>2</b> bookdown Tips for This Document</a><ul>
<li class="chapter" data-level="2.1" data-path="bookdownplan.html"><a href="bookdownplan.html#basic-conventions"><i class="fa fa-check"></i><b>2.1</b> Basic conventions</a></li>
<li class="chapter" data-level="2.2" data-path="bookdownplan.html"><a href="bookdownplan.html#referencing-other-parts-of-the-document"><i class="fa fa-check"></i><b>2.2</b> Referencing other parts of the document</a></li>
<li class="chapter" data-level="2.3" data-path="bookdownplan.html"><a href="bookdownplan.html#inserting-pictures"><i class="fa fa-check"></i><b>2.3</b> Inserting pictures</a></li>
<li class="chapter" data-level="2.4" data-path="bookdownplan.html"><a href="bookdownplan.html#referencing-citations"><i class="fa fa-check"></i><b>2.4</b> Referencing citations:</a></li>
<li class="chapter" data-level="2.5" data-path="bookdownplan.html"><a href="bookdownplan.html#nifty-test-figure."><i class="fa fa-check"></i><b>2.5</b> Nifty test figure.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataexploration.html"><a href="dataexploration.html"><i class="fa fa-check"></i><b>3</b> Data Exploration</a><ul>
<li class="chapter" data-level="3.1" data-path="dataexploration.html"><a href="dataexploration.html#counting-things.-the-naming-of-parts."><i class="fa fa-check"></i><b>3.1</b> Counting things. The naming of parts.</a></li>
<li class="chapter" data-level="3.2" data-path="dataexploration.html"><a href="dataexploration.html#fct_infreq"><i class="fa fa-check"></i><b>3.2</b> fct_infreq</a></li>
<li class="chapter" data-level="3.3" data-path="dataexploration.html"><a href="dataexploration.html#summarize-is-another-very-useful-function"><i class="fa fa-check"></i><b>3.3</b> Summarize is another very useful function:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>4</b> Sampling</a><ul>
<li class="chapter" data-level="4.1" data-path="sampling.html"><a href="sampling.html#think-about-throwing-a-bunch-of-dice."><i class="fa fa-check"></i><b>4.1</b> Think about throwing a bunch of dice.</a></li>
<li class="chapter" data-level="4.2" data-path="sampling.html"><a href="sampling.html#a-keen-way-to-divide-up-a-dataset-into-testing-and-training-components."><i class="fa fa-check"></i><b>4.2</b> A keen way to divide up a dataset into testing and training components.</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="factorpractice.html"><a href="factorpractice.html"><i class="fa fa-check"></i><b>5</b> Factor Practice</a><ul>
<li class="chapter" data-level="5.1" data-path="factorpractice.html"><a href="factorpractice.html#the-basic-structure"><i class="fa fa-check"></i><b>5.1</b> The basic structure</a></li>
<li class="chapter" data-level="5.2" data-path="factorpractice.html"><a href="factorpractice.html#not-all-nominal-data-is-a-factor"><i class="fa fa-check"></i><b>5.2</b> Not all nominal data is a factor</a></li>
<li class="chapter" data-level="5.3" data-path="factorpractice.html"><a href="factorpractice.html#making-variables-into-factors"><i class="fa fa-check"></i><b>5.3</b> Making variables into factors</a></li>
<li class="chapter" data-level="5.4" data-path="factorpractice.html"><a href="factorpractice.html#inspecting-factors"><i class="fa fa-check"></i><b>5.4</b> Inspecting factors</a></li>
<li class="chapter" data-level="5.5" data-path="factorpractice.html"><a href="factorpractice.html#fct_lump"><i class="fa fa-check"></i><b>5.5</b> fct_lump()</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="crossingtrial.html"><a href="crossingtrial.html"><i class="fa fa-check"></i><b>6</b> Crossing Trial</a></li>
<li class="chapter" data-level="7" data-path="changenames.html"><a href="changenames.html"><i class="fa fa-check"></i><b>7</b> By Any Other Name</a><ul>
<li class="chapter" data-level="7.1" data-path="changenames.html"><a href="changenames.html#a-financial-example"><i class="fa fa-check"></i><b>7.1</b> A financial example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>8</b> Correlation Plots</a></li>
<li class="chapter" data-level="9" data-path="ifelsecasewhen.html"><a href="ifelsecasewhen.html"><i class="fa fa-check"></i><b>9</b> if_else() and case_when(): Comparison</a><ul>
<li class="chapter" data-level="9.1" data-path="ifelsecasewhen.html"><a href="ifelsecasewhen.html#case_when"><i class="fa fa-check"></i><b>9.1</b> case_when()</a></li>
<li class="chapter" data-level="9.2" data-path="ifelsecasewhen.html"><a href="ifelsecasewhen.html#compare-this-with-if_else"><i class="fa fa-check"></i><b>9.2</b> Compare this with if_else()</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>10</b> Subsetting</a><ul>
<li class="chapter" data-level="10.1" data-path="subset.html"><a href="subset.html#subsetting-using-brackets"><i class="fa fa-check"></i><b>10.1</b> Subsetting using brackets</a></li>
<li class="chapter" data-level="10.2" data-path="subset.html"><a href="subset.html#subset-using-brackets-by-omitting-the-rows-and-columns-we-dont-want"><i class="fa fa-check"></i><b>10.2</b> Subset using brackets by omitting the rows and columns we don’t want</a></li>
<li class="chapter" data-level="10.3" data-path="subset.html"><a href="subset.html#subset-using-brackets-in-combination-with-the-which-function-and-the-in-operator"><i class="fa fa-check"></i><b>10.3</b> Subset using brackets in combination with the which() function and the %in% operator</a></li>
<li class="chapter" data-level="10.4" data-path="subset.html"><a href="subset.html#subset-using-the-subset-function"><i class="fa fa-check"></i><b>10.4</b> Subset using the subset() function</a></li>
<li class="chapter" data-level="10.5" data-path="subset.html"><a href="subset.html#subset-using-dyplyrs-filter-and-select"><i class="fa fa-check"></i><b>10.5</b> Subset using dyplyr’s filter() and select()</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="simulating-data.html"><a href="simulating-data.html"><i class="fa fa-check"></i><b>11</b> Simulating data</a><ul>
<li class="chapter" data-level="11.1" data-path="simulating-data.html"><a href="simulating-data.html#sample"><i class="fa fa-check"></i><b>11.1</b> Sample()</a></li>
<li class="chapter" data-level="11.2" data-path="simulating-data.html"><a href="simulating-data.html#replicate"><i class="fa fa-check"></i><b>11.2</b> replicate()</a></li>
<li class="chapter" data-level="11.3" data-path="simulating-data.html"><a href="simulating-data.html#sample-revisited"><i class="fa fa-check"></i><b>11.3</b> sample() revisited</a></li>
<li class="chapter" data-level="11.4" data-path="simulating-data.html"><a href="simulating-data.html#generating-fixed-levels--"><i class="fa fa-check"></i><b>11.4</b> generating fixed levels ————————————————-</a></li>
<li class="chapter" data-level="11.5" data-path="simulating-data.html"><a href="simulating-data.html#generating-numerical-sequences"><i class="fa fa-check"></i><b>11.5</b> generating numerical sequences</a></li>
<li class="chapter" data-level="11.6" data-path="simulating-data.html"><a href="simulating-data.html#seq_along-and-seq_len."><i class="fa fa-check"></i><b>11.6</b> seq_along() and seq_len().</a></li>
<li class="chapter" data-level="11.7" data-path="simulating-data.html"><a href="simulating-data.html#generating-random-data-from-a-probability-distribution"><i class="fa fa-check"></i><b>11.7</b> generating random data from a probability distribution</a></li>
<li class="chapter" data-level="11.8" data-path="simulating-data.html"><a href="simulating-data.html#normal-distribution"><i class="fa fa-check"></i><b>11.8</b> Normal distribution:</a></li>
<li class="chapter" data-level="11.9" data-path="simulating-data.html"><a href="simulating-data.html#binomial-distribution"><i class="fa fa-check"></i><b>11.9</b> Binomial distribution:</a></li>
<li class="chapter" data-level="11.10" data-path="simulating-data.html"><a href="simulating-data.html#uniform-distribution"><i class="fa fa-check"></i><b>11.10</b> Uniform distribution</a></li>
<li class="chapter" data-level="11.11" data-path="simulating-data.html"><a href="simulating-data.html#sampling-from-multiple-distributions-building-in-a-difference"><i class="fa fa-check"></i><b>11.11</b> Sampling from multiple distributions (building in a “difference”)</a></li>
<li class="chapter" data-level="11.12" data-path="simulating-data.html"><a href="simulating-data.html#the-good-stuff-building-in-a-difference-based-on-a-categorical-variable"><i class="fa fa-check"></i><b>11.12</b> The good stuff: building in a difference based on a categorical variable</a></li>
<li class="chapter" data-level="11.13" data-path="simulating-data.html"><a href="simulating-data.html#a-demonstration-of-the-central-limit-theorem"><i class="fa fa-check"></i><b>11.13</b> A demonstration of the Central Limit Theorem</a></li>
<li class="chapter" data-level="11.14" data-path="simulating-data.html"><a href="simulating-data.html#overlaying-normal-curve-on-histogram"><i class="fa fa-check"></i><b>11.14</b> Overlaying normal curve on histogram</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>12</b> Functions</a></li>
<li class="chapter" data-level="13" data-path="relativerisk.html"><a href="relativerisk.html"><i class="fa fa-check"></i><b>13</b> Relative versus absolute risk: display</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="14" data-path="dimensionalityreduction.html"><a href="dimensionalityreduction.html"><i class="fa fa-check"></i><b>14</b> Dimensionality Reduction</a><ul>
<li class="chapter" data-level="14.1" data-path="dimensionalityreduction.html"><a href="dimensionalityreduction.html#experiment-in-showing-dimensionality-reduction-for-pathologists"><i class="fa fa-check"></i><b>14.1</b> Experiment in showing dimensionality reduction for pathologists</a><ul>
<li class="chapter" data-level="14.1.1" data-path="dimensionalityreduction.html"><a href="dimensionalityreduction.html#principle-component-analysis"><i class="fa fa-check"></i><b>14.1.1</b> Principle component analysis</a></li>
<li class="chapter" data-level="14.1.2" data-path="dimensionalityreduction.html"><a href="dimensionalityreduction.html#t-distributed-stochastic-neighbor-embedding"><i class="fa fa-check"></i><b>14.1.2</b> t-distributed stochastic neighbor embedding</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bill’s Drills Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulating-data" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Simulating data</h1>
<p>I’ve just begun to explore R, and I realize that many of my questions could be improved with example data. Generating this kind of data takes practice, though.</p>
<p>Some good websites:
<a href="https://clayford.github.io/dwir/dwr_12_generating_data.html" class="uri">https://clayford.github.io/dwir/dwr_12_generating_data.html</a></p>
<p><a href="https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html" class="uri">https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html</a></p>
<p><a href="https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/" class="uri">https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/</a></p>
<p>Also, remember that R packages have a lot of great data.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="simulating-data.html#cb133-1"></a><span class="kw">data</span>()</span></code></pre></div>
<div id="sample" class="section level2">
<h2><span class="header-section-number">11.1</span> Sample()</h2>
<p>Starting with Clayford’s nice (and long page):</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="simulating-data.html#cb134-1"></a><span class="kw">sample</span>(<span class="dv">5</span>) <span class="co">#sample without replacement</span></span></code></pre></div>
<pre><code>## [1] 4 5 1 2 3</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="simulating-data.html#cb136-1"></a><span class="co"># or generate a random permutation of a vector:</span></span>
<span id="cb136-2"><a href="simulating-data.html#cb136-2"></a>dat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">9</span>)</span>
<span id="cb136-3"><a href="simulating-data.html#cb136-3"></a><span class="kw">sample</span>(dat)</span></code></pre></div>
<pre><code>## [1] 10 12 18 18 16  9</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="simulating-data.html#cb138-1"></a><span class="co"># bootstrap resampling: sampling the same number of items WITH replacement. The bootstrap method is a resampling technique used to estimate statistics on a population by sampling a dataset with replacement. </span></span>
<span id="cb138-2"><a href="simulating-data.html#cb138-2"></a><span class="kw">sample</span>(dat, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<pre><code>## [1]  9 10 18 18 18 10</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="simulating-data.html#cb140-1"></a><span class="kw">rm</span>(dat)</span>
<span id="cb140-2"><a href="simulating-data.html#cb140-2"></a></span>
<span id="cb140-3"><a href="simulating-data.html#cb140-3"></a><span class="kw">sample</span>(state.abb, <span class="dt">size =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;RI&quot; &quot;LA&quot; &quot;FL&quot; &quot;MD&quot; &quot;TX&quot; &quot;WV&quot; &quot;AK&quot; &quot;NE&quot; &quot;WA&quot; &quot;AZ&quot;</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="simulating-data.html#cb142-1"></a><span class="co"># Using 1:6 and size=1, we can simulate the roll of a die:</span></span>
<span id="cb142-2"><a href="simulating-data.html#cb142-2"></a><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="simulating-data.html#cb144-1"></a><span class="co"># We can simulate the roll of a die 100 times by setting size=100 and</span></span>
<span id="cb144-2"><a href="simulating-data.html#cb144-2"></a><span class="co"># replace=TRUE</span></span>
<span id="cb144-3"><a href="simulating-data.html#cb144-3"></a><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##   [1] 5 6 3 1 5 1 5 1 3 1 1 3 3 4 5 4 4 5 6 4 2 1 5 6 6 1 3 3 4 1 4 5 4 6 6 4 5
##  [38] 6 4 6 1 4 1 3 4 1 1 5 4 3 1 2 5 5 2 2 1 3 5 6 4 4 1 3 4 3 4 5 2 2 4 2 5 4
##  [75] 4 5 4 3 4 1 4 1 1 1 5 6 1 4 5 5 5 5 2 3 6 2 2 5 4 1</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="simulating-data.html#cb146-1"></a><span class="co"># sample produces a vector, so we can manipulate it as we would any other </span></span>
<span id="cb146-2"><a href="simulating-data.html#cb146-2"></a><span class="co"># vector. For example, simulate a 100 die rolls and tally up the totals using</span></span>
<span id="cb146-3"><a href="simulating-data.html#cb146-3"></a><span class="co"># table() and prop.table():</span></span>
<span id="cb146-4"><a href="simulating-data.html#cb146-4"></a><span class="kw">table</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## 
##  1  2  3  4  5  6 
##  8 27 19 17 19 10</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="simulating-data.html#cb148-1"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)))</span></code></pre></div>
<pre><code>## 
##    1    2    3    4    5    6 
## 0.15 0.11 0.19 0.19 0.14 0.22</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="simulating-data.html#cb150-1"></a><span class="kw">table</span>(<span class="kw">sample</span>(state.abb, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## 
## AK AL AR AZ CA CO CT DE FL GA HI IA ID IL IN KS KY LA MA MD ME MI MN MO MS MT 
## 19 14 14 24 23 19 28 17 25 20 25 23 21 23 16 21 17 10 18 20 19 30 24 19 21 23 
## NC ND NE NH NJ NM NV NY OH OK OR PA RI SC SD TN TX UT VA VT WA WI WV WY 
## 18 23 18 23 10 18 19 13 19 23 15 25 26 17 18 19 20 24 19 22 17 14 28 19</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="simulating-data.html#cb152-1"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">sample</span>(state.abb, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)))</span></code></pre></div>
<pre><code>## 
##    AK    AL    AR    AZ    CA    CO    CT    DE    FL    GA    HI    IA    ID 
## 0.016 0.021 0.024 0.013 0.018 0.023 0.025 0.020 0.030 0.015 0.026 0.020 0.024 
##    IL    IN    KS    KY    LA    MA    MD    ME    MI    MN    MO    MS    MT 
## 0.029 0.027 0.024 0.020 0.017 0.021 0.022 0.021 0.021 0.025 0.016 0.015 0.015 
##    NC    ND    NE    NH    NJ    NM    NV    NY    OH    OK    OR    PA    RI 
## 0.018 0.018 0.014 0.018 0.013 0.022 0.021 0.022 0.022 0.017 0.022 0.016 0.017 
##    SC    SD    TN    TX    UT    VA    VT    WA    WI    WV    WY 
## 0.016 0.018 0.017 0.028 0.021 0.019 0.011 0.019 0.020 0.025 0.018</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="simulating-data.html#cb154-1"></a><span class="co"># using the forward-pipe operator: %&gt;% </span></span>
<span id="cb154-2"><a href="simulating-data.html#cb154-2"></a><span class="kw">library</span>(magrittr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;magrittr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="simulating-data.html#cb158-1"></a><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">table</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">prop.table</span>()</span></code></pre></div>
<pre><code>## .
##    1    2    3    4    5    6 
## 0.16 0.19 0.13 0.14 0.21 0.17</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="simulating-data.html#cb160-1"></a><span class="co"># Or simulate rolling two dice and summing the total:</span></span>
<span id="cb160-2"><a href="simulating-data.html#cb160-2"></a><span class="kw">sum</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="simulating-data.html#cb162-1"></a><span class="co"># same thing with %&gt;% </span></span>
<span id="cb162-2"><a href="simulating-data.html#cb162-2"></a><span class="kw">sample</span>(<span class="dv">6</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sum</span>()</span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="simulating-data.html#cb164-1"></a><span class="co"># simulate rolling two dice 100 times by updating the sample &quot;space&quot;</span></span>
<span id="cb164-2"><a href="simulating-data.html#cb164-2"></a><span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">size=</span><span class="dv">100</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##   [1]  3 12  5  5  4  4  4  6  3  9  2 10 12  8  8  4  2  8  9  7  8  8  9 12  8
##  [26]  8 12  6 11  2  5  2  8  3  3  3  8  4  4  5  4  9  4 11  4  7  7  4  5  2
##  [51]  9  7  5  5 12  3  7  2  3  6  6  6  2 11  6  6  8  4 12 12  8 10  3 11  6
##  [76] 12  7 11  6  3  9  2 11  3  9 10  5  9  4  3  9  4 12  8  5  5 10  7  9  6</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="simulating-data.html#cb166-1"></a><span class="co"># proportion of &quot;snake-eyes&quot; in 1000 rolls</span></span>
<span id="cb166-2"><a href="simulating-data.html#cb166-2"></a><span class="kw">mean</span>(<span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.101</code></pre>
</div>
<div id="replicate" class="section level2">
<h2><span class="header-section-number">11.2</span> replicate()</h2>
<p>We can use the replicate() function to replicate samples. The replicate()
function allows you to replicate an expression as many times as you specify.
The basix syntax is replicate(n, expr) where n is the number of replications
and expr is the expression you want to replicate.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="simulating-data.html#cb168-1"></a><span class="co"># Roll 2 dice and keep the largest number, 10,000 times:</span></span>
<span id="cb168-2"><a href="simulating-data.html#cb168-2"></a>rolls &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dt">n=</span><span class="fl">1e5</span>, <span class="dt">expr =</span> <span class="kw">max</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)))</span>
<span id="cb168-3"><a href="simulating-data.html#cb168-3"></a><span class="co"># calculate proportions:</span></span>
<span id="cb168-4"><a href="simulating-data.html#cb168-4"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(rolls))</span></code></pre></div>
<pre><code>## rolls
##       1       2       3       4       5       6 
## 0.02813 0.08285 0.13635 0.19458 0.25246 0.30563</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="simulating-data.html#cb170-1"></a><span class="kw">barplot</span>(<span class="kw">table</span>(rolls))</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="simulating-data.html#cb171-1"></a><span class="kw">rm</span>(rolls)</span></code></pre></div>
</div>
<div id="sample-revisited" class="section level2">
<h2><span class="header-section-number">11.3</span> sample() revisited</h2>
<p>The sample function also has a prob argument that allows you to assign
probabilities to your items. For example to simulate the flip of a loaded
coin, with Tails having probability 0.65:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="simulating-data.html#cb172-1"></a>flips &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;T&quot;</span>), <span class="dv">1000</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.35</span>,<span class="fl">0.65</span>))</span>
<span id="cb172-2"><a href="simulating-data.html#cb172-2"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(flips))</span></code></pre></div>
<pre><code>## flips
##     H     T 
## 0.323 0.677</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="simulating-data.html#cb174-1"></a><span class="kw">rm</span>(flips)</span></code></pre></div>
<p>Coins are nice, but we can also use sample to generate practical data, for
example males and females. A web site says UVa has 11,632 female
students and 10,353 male students as of Fall 2015.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="simulating-data.html#cb175-1"></a>uva &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">11632</span>, <span class="dv">10353</span>) <span class="co"># female, male</span></span>
<span id="cb175-2"><a href="simulating-data.html#cb175-2"></a><span class="kw">round</span>(uva<span class="op">/</span><span class="kw">sum</span>(uva),<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.53 0.47</code></pre>
<p>Note how elegantly this answers a basic question. Nice!</p>
<p>We can generate a fake random sample of 500 UVa students with a weighted sampling scheme like so:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="simulating-data.html#cb177-1"></a>students &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>), <span class="dv">500</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.53</span>, <span class="fl">0.47</span>))</span>
<span id="cb177-2"><a href="simulating-data.html#cb177-2"></a><span class="kw">prop.table</span>(<span class="kw">table</span>(students))</span></code></pre></div>
<pre><code>## students
## female   male 
##  0.462  0.538</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="simulating-data.html#cb179-1"></a><span class="kw">rm</span>(students, uva)</span></code></pre></div>
<p>When used with subsetting brackets, sample() can be used to create training
and test sets. For example, say we want to build some sort of predictive model using our training data. We may want to use half our data to build the model and then use the other half to evaluate its performance.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="simulating-data.html#cb180-1"></a>train &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(iris), <span class="dt">size=</span> <span class="kw">nrow</span>(iris)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb180-2"><a href="simulating-data.html#cb180-2"></a></span>
<span id="cb180-3"><a href="simulating-data.html#cb180-3"></a><span class="co"># train is a random sample of numbers from 1 - 365. We can treat these like row numbers.</span></span>
<span id="cb180-4"><a href="simulating-data.html#cb180-4"></a></span>
<span id="cb180-5"><a href="simulating-data.html#cb180-5"></a>irisTrain &lt;-<span class="st"> </span>iris[train,]</span>
<span id="cb180-6"><a href="simulating-data.html#cb180-6"></a>irisTest &lt;-<span class="st"> </span>iris[<span class="op">-</span>train,]</span>
<span id="cb180-7"><a href="simulating-data.html#cb180-7"></a><span class="co"># confirm no intersection</span></span>
<span id="cb180-8"><a href="simulating-data.html#cb180-8"></a>dplyr<span class="op">::</span><span class="kw">intersect</span>(irisTrain, irisTest) </span></code></pre></div>
<pre><code>## [1] Sepal.Length Sepal.Width  Petal.Length Petal.Width  Species     
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="simulating-data.html#cb182-1"></a><span class="kw">rm</span>(train, irisTest, irisTrain)</span></code></pre></div>
</div>
<div id="generating-fixed-levels--" class="section level2">
<h2><span class="header-section-number">11.4</span> generating fixed levels ————————————————-</h2>
<p>Often generating data means creating a series of fixed levels, such as 10
males and 10 females. The rep() function can be useful for this. Below we
replicate 10 each of “M” and “F”:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="simulating-data.html#cb183-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), <span class="dt">each=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;M&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot; &quot;F&quot;
## [20] &quot;F&quot;</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="simulating-data.html#cb185-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), <span class="dt">times=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot;
## [20] &quot;F&quot;</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="simulating-data.html#cb187-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), <span class="dt">length.out =</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot;</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="simulating-data.html#cb189-1"></a><span class="co"># or just length, for short</span></span>
<span id="cb189-2"><a href="simulating-data.html#cb189-2"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), <span class="dt">length =</span> <span class="dv">15</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot; &quot;F&quot; &quot;M&quot;</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="simulating-data.html#cb191-1"></a><span class="co"># Notice that all these generated a character vector. To use as a &quot;factor&quot;, we would need to wrap it in the factor() function.</span></span>
<span id="cb191-2"><a href="simulating-data.html#cb191-2"></a><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), <span class="dt">each=</span><span class="dv">10</span>))</span></code></pre></div>
<pre><code>##  [1] M M M M M M M M M M F F F F F F F F F F
## Levels: F M</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="simulating-data.html#cb193-1"></a><span class="co"># A function specifically for creating factors is the gl() function. gl = </span></span>
<span id="cb193-2"><a href="simulating-data.html#cb193-2"></a><span class="co"># &quot;generate levels&quot;. Below we generate a factor with 2 levels of 10 each and </span></span>
<span id="cb193-3"><a href="simulating-data.html#cb193-3"></a><span class="co"># labels of &quot;M&quot; and &quot;F&quot;. Notice the result is a factor.</span></span>
<span id="cb193-4"><a href="simulating-data.html#cb193-4"></a><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="dv">10</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>))</span></code></pre></div>
<pre><code>##  [1] M M M M M M M M M M F F F F F F F F F F
## Levels: M F</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="simulating-data.html#cb195-1"></a><span class="co"># A more common occurence is combinations of fixed levels, say gender, </span></span>
<span id="cb195-2"><a href="simulating-data.html#cb195-2"></a><span class="co"># education, and status. A function that helps create every combination of </span></span>
<span id="cb195-3"><a href="simulating-data.html#cb195-3"></a><span class="co"># levels is expand.grid(). Below we generate every combination of the levels </span></span>
<span id="cb195-4"><a href="simulating-data.html#cb195-4"></a><span class="co"># provided for gender, education, and status. Notice the first factors vary</span></span>
<span id="cb195-5"><a href="simulating-data.html#cb195-5"></a><span class="co"># fastest.</span></span>
<span id="cb195-6"><a href="simulating-data.html#cb195-6"></a><span class="kw">expand.grid</span>(<span class="dt">gender=</span><span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), </span>
<span id="cb195-7"><a href="simulating-data.html#cb195-7"></a>            <span class="dt">education=</span><span class="kw">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;College&quot;</span>,<span class="st">&quot;Advanced&quot;</span>), </span>
<span id="cb195-8"><a href="simulating-data.html#cb195-8"></a>            <span class="dt">status=</span><span class="kw">c</span>(<span class="st">&quot;Single&quot;</span>,<span class="st">&quot;Married&quot;</span>,<span class="st">&quot;Divorced&quot;</span>,<span class="st">&quot;Widowed&quot;</span>))</span></code></pre></div>
<pre><code>##    gender education   status
## 1       M        HS   Single
## 2       F        HS   Single
## 3       M   College   Single
## 4       F   College   Single
## 5       M  Advanced   Single
## 6       F  Advanced   Single
## 7       M        HS  Married
## 8       F        HS  Married
## 9       M   College  Married
## 10      F   College  Married
## 11      M  Advanced  Married
## 12      F  Advanced  Married
## 13      M        HS Divorced
## 14      F        HS Divorced
## 15      M   College Divorced
## 16      F   College Divorced
## 17      M  Advanced Divorced
## 18      F  Advanced Divorced
## 19      M        HS  Widowed
## 20      F        HS  Widowed
## 21      M   College  Widowed
## 22      F   College  Widowed
## 23      M  Advanced  Widowed
## 24      F  Advanced  Widowed</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="simulating-data.html#cb197-1"></a><span class="co"># Notice that creates a data frame that we can save:</span></span>
<span id="cb197-2"><a href="simulating-data.html#cb197-2"></a>DF &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">gender=</span><span class="kw">c</span>(<span class="st">&quot;M&quot;</span>,<span class="st">&quot;F&quot;</span>), </span>
<span id="cb197-3"><a href="simulating-data.html#cb197-3"></a>            <span class="dt">education=</span><span class="kw">c</span>(<span class="st">&quot;HS&quot;</span>,<span class="st">&quot;College&quot;</span>,<span class="st">&quot;Advanced&quot;</span>), </span>
<span id="cb197-4"><a href="simulating-data.html#cb197-4"></a>            <span class="dt">status=</span><span class="kw">c</span>(<span class="st">&quot;Single&quot;</span>,<span class="st">&quot;Married&quot;</span>,<span class="st">&quot;Divorced&quot;</span>,<span class="st">&quot;Widowed&quot;</span>))</span>
<span id="cb197-5"><a href="simulating-data.html#cb197-5"></a><span class="kw">class</span>(DF)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="simulating-data.html#cb199-1"></a><span class="kw">rm</span>(DF)</span></code></pre></div>
<p>Or imagine an experiment where 3 people throw 3 different kinds of paper airplanes, made of 3 paper types (3x3 = 9 planes), throwing each plane 8 times.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="simulating-data.html#cb200-1"></a>schedule &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">thrower=</span><span class="kw">c</span>(<span class="st">&quot;Clay&quot;</span>,<span class="st">&quot;Rod&quot;</span>,<span class="st">&quot;Kevin&quot;</span>),</span>
<span id="cb200-2"><a href="simulating-data.html#cb200-2"></a>            <span class="dt">paper=</span><span class="kw">c</span>(<span class="st">&quot;18&quot;</span>, <span class="st">&quot;20&quot;</span>, <span class="st">&quot;24&quot;</span>),</span>
<span id="cb200-3"><a href="simulating-data.html#cb200-3"></a>            <span class="dt">design=</span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>),</span>
<span id="cb200-4"><a href="simulating-data.html#cb200-4"></a>            <span class="dt">rep=</span><span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</span>
<span id="cb200-5"><a href="simulating-data.html#cb200-5"></a></span>
<span id="cb200-6"><a href="simulating-data.html#cb200-6"></a><span class="co"># Randomize and drop the rep column. The sample(nrow(schedule)) code scrambles the numbers 1 through 216, which I then use to randomly shuffle the schedule of throws.</span></span>
<span id="cb200-7"><a href="simulating-data.html#cb200-7"></a>k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(schedule))</span>
<span id="cb200-8"><a href="simulating-data.html#cb200-8"></a>schedule &lt;-<span class="st"> </span>schedule[k,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb200-9"><a href="simulating-data.html#cb200-9"></a><span class="kw">head</span>(schedule, <span class="dt">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##     thrower paper design
## 104     Rod    20      c
## 146     Rod    18      b
## 139    Clay    20      a
## 79     Clay    24      c
## 10     Clay    18      b
## 94     Clay    20      b
## 112    Clay    20      a
## 183   Kevin    18      c
## 196    Clay    24      a
## 35      Rod    24      a</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="simulating-data.html#cb202-1"></a><span class="co"># output to csv file for logging &quot;distance flown&quot; data</span></span>
<span id="cb202-2"><a href="simulating-data.html#cb202-2"></a><span class="kw">write.csv</span>(schedule, <span class="dt">file=</span><span class="st">&quot;throwLog.csv&quot;</span>, <span class="dt">row.names=</span><span class="ot">FALSE</span>)</span>
<span id="cb202-3"><a href="simulating-data.html#cb202-3"></a></span>
<span id="cb202-4"><a href="simulating-data.html#cb202-4"></a><span class="kw">rm</span>(k, schedule)</span></code></pre></div>
<p>This is a great way to set up an experiment, but I’d like to <strong>also</strong> add data for the throw, based on interesting distributions (normal, etc.). How would I generate samples for each contestant that was based on slightly different distributions?</p>
<p>What sort of distribution? See this page to get a quick refresher on common distributions: <a href="https://www.analyticsvidhya.com/blog/2017/09/6-probability-distributions-data-science/" class="uri">https://www.analyticsvidhya.com/blog/2017/09/6-probability-distributions-data-science/</a>.</p>
<p>Note also that ?distributions gives you the distributions in {stats}. Persevere for a time.</p>
</div>
<div id="generating-numerical-sequences" class="section level2">
<h2><span class="header-section-number">11.5</span> generating numerical sequences</h2>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="simulating-data.html#cb203-1"></a><span class="co"># The seq() function allows you to generate sequences of numbers:</span></span>
<span id="cb203-2"><a href="simulating-data.html#cb203-2"></a><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1]  0  2  4  6  8 10</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="simulating-data.html#cb205-1"></a><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>##  [1]  0.0  0.2  0.4  0.6  0.8  1.0  1.2  1.4  1.6  1.8  2.0  2.2  2.4  2.6  2.8
## [16]  3.0  3.2  3.4  3.6  3.8  4.0  4.2  4.4  4.6  4.8  5.0  5.2  5.4  5.6  5.8
## [31]  6.0  6.2  6.4  6.6  6.8  7.0  7.2  7.4  7.6  7.8  8.0  8.2  8.4  8.6  8.8
## [46]  9.0  9.2  9.4  9.6  9.8 10.0</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="simulating-data.html#cb207-1"></a><span class="co"># Go backwards</span></span>
<span id="cb207-2"><a href="simulating-data.html#cb207-2"></a><span class="kw">seq</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">-100</span>)</span></code></pre></div>
<pre><code>##  [1] 1000  900  800  700  600  500  400  300  200  100    0</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="simulating-data.html#cb209-1"></a><span class="co"># The seq() function has a length.out argument that allows you to specify the</span></span>
<span id="cb209-2"><a href="simulating-data.html#cb209-2"></a><span class="co"># size of the vector you want to create. It automatically calculates the</span></span>
<span id="cb209-3"><a href="simulating-data.html#cb209-3"></a><span class="co"># increment. We usually just abbreviate to length</span></span>
<span id="cb209-4"><a href="simulating-data.html#cb209-4"></a><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">length =</span> <span class="dv">30</span>)</span></code></pre></div>
<pre><code>##  [1]  1.000000  1.310345  1.620690  1.931034  2.241379  2.551724  2.862069
##  [8]  3.172414  3.482759  3.793103  4.103448  4.413793  4.724138  5.034483
## [15]  5.344828  5.655172  5.965517  6.275862  6.586207  6.896552  7.206897
## [22]  7.517241  7.827586  8.137931  8.448276  8.758621  9.068966  9.379310
## [29]  9.689655 10.000000</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="simulating-data.html#cb211-1"></a><span class="co"># The colon operator(:) also allows you to generate regular sequences in steps</span></span>
<span id="cb211-2"><a href="simulating-data.html#cb211-2"></a><span class="co"># of 1.</span></span>
<span id="cb211-3"><a href="simulating-data.html#cb211-3"></a><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="simulating-data.html#cb213-1"></a><span class="dv">10</span><span class="op">:-</span><span class="dv">10</span> <span class="co"># reverse direction</span></span></code></pre></div>
<pre><code>##  [1]  10   9   8   7   6   5   4   3   2   1   0  -1  -2  -3  -4  -5  -6  -7  -8
## [20]  -9 -10</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="simulating-data.html#cb215-1"></a><span class="co"># When used with factors, the colon operator generates an interaction factor:</span></span>
<span id="cb215-2"><a href="simulating-data.html#cb215-2"></a>f1 &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">k =</span> <span class="dv">3</span>); f1</span></code></pre></div>
<pre><code>## [1] 1 1 1 2 2 2
## Levels: 1 2</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="simulating-data.html#cb217-1"></a>f2 &lt;-<span class="st"> </span><span class="kw">gl</span>(<span class="dt">n =</span> <span class="dv">3</span>, <span class="dt">k =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)); f2</span></code></pre></div>
<pre><code>## [1] a a b b c c
## Levels: a b c</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="simulating-data.html#cb219-1"></a>f1<span class="op">:</span>f2</span></code></pre></div>
<pre><code>## [1] 1:a 1:a 1:b 2:b 2:c 2:c
## Levels: 1:a 1:b 1:c 2:a 2:b 2:c</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="simulating-data.html#cb221-1"></a><span class="kw">rm</span>(f1,f2)</span></code></pre></div>
<p>The last step seems akin to perfectly shuffling two decks of cards (the decks must be of equal length).</p>
</div>
<div id="seq_along-and-seq_len." class="section level2">
<h2><span class="header-section-number">11.6</span> seq_along() and seq_len().</h2>
<p>seq_along() returns the indices of a vector while seq_len(n) returns an integer vector of 1:n.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="simulating-data.html#cb222-1"></a><span class="kw">seq_along</span>(<span class="dv">100</span><span class="op">:</span><span class="dv">120</span>)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="simulating-data.html#cb224-1"></a><span class="kw">seq_along</span>(state.abb)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
## [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="simulating-data.html#cb226-1"></a><span class="kw">seq_len</span>(<span class="dv">12</span>)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12</code></pre>
</div>
<div id="generating-random-data-from-a-probability-distribution" class="section level2">
<h2><span class="header-section-number">11.7</span> generating random data from a probability distribution</h2>
<p>A central idea in inferential statistics is that the distribution of data can often be approximated by a theoretical distribution. R provides functions for working with several well-known theoretical distributions, including the
ability to generate data from those distributions. A common one is the rnorm() function which generates data from a Normal distribution.</p>
<p>In R, the functions for theoretical distributions take the form of dxxx, pxxx, qxxx and rxxx.</p>
<ul>
<li>dxxx is for the probability density/mass function (dnorm)</li>
<li>pxxx is for the cumulative distribution function (pnorm)</li>
<li>qxxx is for the quantile function (qnorm)</li>
<li>rxxx is for random variate generation (rnorm)</li>
</ul>
<p>For random variate generation we’re interested in the rxxx variety.</p>
</div>
<div id="normal-distribution" class="section level2">
<h2><span class="header-section-number">11.8</span> Normal distribution:</h2>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="simulating-data.html#cb228-1"></a><span class="co"># 10 random draws from N(100,5)</span></span>
<span id="cb228-2"><a href="simulating-data.html#cb228-2"></a><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">100</span>, <span class="dt">sd =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##  [1] 101.27360  88.61725 112.49156  99.30521 103.86910 103.87714 100.71628
##  [8] 100.07492 102.82459 108.60936</code></pre>
</div>
<div id="binomial-distribution" class="section level2">
<h2><span class="header-section-number">11.9</span> Binomial distribution:</h2>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="simulating-data.html#cb230-1"></a><span class="co"># 10 random draws from b(1,0.5)</span></span>
<span id="cb230-2"><a href="simulating-data.html#cb230-2"></a><span class="co"># AKA, 10 coin flips (size is the number of trials)</span></span>
<span id="cb230-3"><a href="simulating-data.html#cb230-3"></a><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 1 0 1 0 1 1 1 0 1 1</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="simulating-data.html#cb232-1"></a><span class="co"># 10 random draws from b(1,0.8)</span></span>
<span id="cb232-2"><a href="simulating-data.html#cb232-2"></a><span class="co"># AKA, 10 coin flips with a coin loaded Heads (or Tails) 80% of time</span></span>
<span id="cb232-3"><a href="simulating-data.html#cb232-3"></a><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>##  [1] 0 1 1 1 1 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="simulating-data.html#cb234-1"></a><span class="co"># 10 random draws from b(10,0.5)</span></span>
<span id="cb234-2"><a href="simulating-data.html#cb234-2"></a><span class="co"># AKA, 10 results of 10 coin flips</span></span>
<span id="cb234-3"><a href="simulating-data.html#cb234-3"></a><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##  [1] 9 4 8 6 2 6 5 4 4 5</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="simulating-data.html#cb236-1"></a><span class="co"># We can use a binomial distribution to simulate dichotmous answers such as </span></span>
<span id="cb236-2"><a href="simulating-data.html#cb236-2"></a><span class="co"># Yes/No or success/fail. Simulate a vector of responses where respondents are 65% likely to say Yes (1) versus No (0)</span></span>
<span id="cb236-3"><a href="simulating-data.html#cb236-3"></a><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.65</span>)</span></code></pre></div>
<pre><code>##  [1] 1 1 0 1 1 1 1 1 0 1</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="simulating-data.html#cb238-1"></a><span class="co"># could also just use sample</span></span>
<span id="cb238-2"><a href="simulating-data.html#cb238-2"></a><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Y&quot;</span>,<span class="st">&quot;N&quot;</span>), <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(.<span class="dv">65</span>, <span class="fl">.35</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;N&quot; &quot;Y&quot;</code></pre>
</div>
<div id="uniform-distribution" class="section level2">
<h2><span class="header-section-number">11.10</span> Uniform distribution</h2>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="simulating-data.html#cb240-1"></a><span class="co"># 10 random draws from a uniform distribution u(0,100)</span></span>
<span id="cb240-2"><a href="simulating-data.html#cb240-2"></a><span class="kw">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">100</span>)</span></code></pre></div>
<pre><code>##  [1] 50.34837 88.96280 18.03323 17.74219 99.83278 47.54181 63.35148 10.48299
##  [9] 52.38249 78.17431</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="simulating-data.html#cb242-1"></a><span class="co"># A uniform distribution can be good for random sampling. Let&#39;s say we want to sample about 10% of iris data:</span></span>
<span id="cb242-2"><a href="simulating-data.html#cb242-2"></a>k &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="kw">nrow</span>(iris),<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># [0,1] interval is default</span></span>
<span id="cb242-3"><a href="simulating-data.html#cb242-3"></a>sbSamp &lt;-<span class="st"> </span>iris[k <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>, ] <span class="co"># sample about 10% of rows</span></span>
<span id="cb242-4"><a href="simulating-data.html#cb242-4"></a><span class="kw">dim</span>(sbSamp)</span></code></pre></div>
<pre><code>## [1] 21  5</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="simulating-data.html#cb244-1"></a><span class="co"># dplyr does this as well without the need for runif; and it&#39;s precise in its</span></span>
<span id="cb244-2"><a href="simulating-data.html#cb244-2"></a><span class="co"># sampling fraction.</span></span>
<span id="cb244-3"><a href="simulating-data.html#cb244-3"></a>sbSamp &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">sample_frac</span>(iris, <span class="fl">0.1</span>) <span class="co"># sample exactly 10% of rows</span></span>
<span id="cb244-4"><a href="simulating-data.html#cb244-4"></a><span class="kw">dim</span>(sbSamp)</span></code></pre></div>
<pre><code>## [1] 15  5</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="simulating-data.html#cb246-1"></a><span class="kw">rm</span>(sbSamp, k)</span></code></pre></div>
</div>
<div id="sampling-from-multiple-distributions-building-in-a-difference" class="section level2">
<h2><span class="header-section-number">11.11</span> Sampling from multiple distributions (building in a “difference”)</h2>
<p>The arguments to rxxx functions can take vectors! This means we can use one
function call to generate draws from multiple distributions.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="simulating-data.html#cb247-1"></a><span class="co"># alternating random values from N(10,4) and N(100,40)</span></span>
<span id="cb247-2"><a href="simulating-data.html#cb247-2"></a><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">100</span>),<span class="dt">sd =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">40</span>))</span></code></pre></div>
<pre><code>##  [1]   2.602207  64.321100   2.032922 121.054752   3.694822 148.521727
##  [7]   6.572839 106.641653  -1.274637 112.095525</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="simulating-data.html#cb249-1"></a><span class="co"># 30 random draws, 10 each from N(10,4), N(90,4) and N(400,4)</span></span>
<span id="cb249-2"><a href="simulating-data.html#cb249-2"></a><span class="kw">rnorm</span>(<span class="dv">30</span>, <span class="dt">mean =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">90</span>,<span class="dv">400</span>),<span class="dt">each=</span><span class="dv">10</span>), <span class="dt">sd =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1]  13.442189  11.814276   8.042744  11.032804   6.725487   7.644664
##  [7]  15.005589   7.799846   9.824663   2.408001  91.457085  86.801938
## [13]  93.875747  87.623842  80.591457  97.105845  85.647415  87.239971
## [19]  90.069110  95.125852 400.054585 405.090048 396.088488 412.025435
## [25] 398.472211 403.735081 402.763459 401.535412 402.840150 397.813341</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="simulating-data.html#cb251-1"></a><span class="co"># 100 random draws, 50 each from b(5,0.5) and b(50,0.5)</span></span>
<span id="cb251-2"><a href="simulating-data.html#cb251-2"></a><span class="kw">rbinom</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">size =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">50</span>),<span class="dt">each=</span><span class="dv">50</span>), <span class="dt">prob =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>##   [1]  3  3  2  2  1  5  2  3  3  2  0  2  3  4  3  2  3  1  2  1  2  2  4  3  4
##  [26]  4  1  3  3  4  4  1  0  3  2  3  3  3  4  5  3  0  3  2  1  2  2  5  1  1
##  [51] 26 26 23 25 24 25 20 22 29 24 28 23 22 24 25 26 23 27 25 30 28 20 27 22 22
##  [76] 24 31 28 21 25 31 21 19 26 20 24 24 31 33 23 26 25 26 24 25 19 25 23 25 24</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="simulating-data.html#cb253-1"></a><span class="co"># Combined with matrix(), one can generate &quot;multiple&quot; random samples from a </span></span>
<span id="cb253-2"><a href="simulating-data.html#cb253-2"></a><span class="co"># distribution. For example, draw 5 random samples of size 10 from a N(10,1):</span></span>
<span id="cb253-3"><a href="simulating-data.html#cb253-3"></a><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10</span><span class="op">*</span><span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">1</span>),<span class="dt">ncol=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##            [,1]      [,2]      [,3]      [,4]      [,5]
##  [1,]  9.447972  9.538527  9.696858  9.759624 10.780563
##  [2,]  9.186559  8.195187 10.005517  9.681449 11.507238
##  [3,] 10.154476  9.539031  9.816230  9.542359  8.672465
##  [4,]  9.269497 11.519775  9.330705 10.654095 10.296286
##  [5,]  9.887437 10.051347  9.204726  9.646104  9.201882
##  [6,] 10.204350 10.380006  8.620772  9.134985  8.987121
##  [7,]  7.680437  8.269766  8.899391  9.975712  8.768231
##  [8,] 10.130204  9.136561  8.210755 10.485433  8.617155
##  [9,] 10.580088  8.363873 11.332057 11.925225 10.130335
## [10,] 10.495338  7.587297  8.773753 12.057087  9.040655</code></pre>
<p>Note that in the last example, we technically drew one sample of size 50 and then laid it out in a 10x5 matrix.</p>
</div>
<div id="the-good-stuff-building-in-a-difference-based-on-a-categorical-variable" class="section level2">
<h2><span class="header-section-number">11.12</span> The good stuff: building in a difference based on a categorical variable</h2>
<p>Using ifelse() we can generate different data based on a TRUE/FALSE condition. Let’s say we have treated and untreated subjects. I’d like to generate Normal data that differs based on the treatment.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="simulating-data.html#cb255-1"></a>trtmt &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&quot;Treated&quot;</span>,<span class="st">&quot;Untreated&quot;</span>), <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb255-2"><a href="simulating-data.html#cb255-2"></a><span class="kw">ifelse</span>(trtmt<span class="op">==</span><span class="st">&quot;Treated&quot;</span>, <span class="dt">yes =</span> <span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">1</span>), <span class="dt">no =</span> <span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>##  [1] 11.269806 21.174261 19.671301 21.154222 10.841186 19.213505 18.774548
##  [8] 20.011264 11.944670  7.922051  9.684268  8.993571 10.883327  9.937337
## [15] 10.794244 11.805633 19.555977 19.877443  9.056013 11.552978</code></pre>
<p>Notice we have to make the length of the yes/no arguments the SAME LENGTH as
the trtmt==“Treated” logical vector! What happens if we use rnorm(n=1,…)?</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="simulating-data.html#cb257-1"></a><span class="co"># What about more than two groups?</span></span>
<span id="cb257-2"><a href="simulating-data.html#cb257-2"></a>n &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb257-3"><a href="simulating-data.html#cb257-3"></a>trtmt &lt;-<span class="st"> </span><span class="kw">sample</span>(LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb257-4"><a href="simulating-data.html#cb257-4"></a></span>
<span id="cb257-5"><a href="simulating-data.html#cb257-5"></a><span class="co"># Say we want to generate differnt Normal data for each group. One way is to do a for-loop with multiple if statements:</span></span>
<span id="cb257-6"><a href="simulating-data.html#cb257-6"></a></span>
<span id="cb257-7"><a href="simulating-data.html#cb257-7"></a>val &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) <span class="co"># empty vector</span></span>
<span id="cb257-8"><a href="simulating-data.html#cb257-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(trtmt)){</span>
<span id="cb257-9"><a href="simulating-data.html#cb257-9"></a>  <span class="cf">if</span>(trtmt[i]<span class="op">==</span><span class="st">&quot;A&quot;</span>) val[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb257-10"><a href="simulating-data.html#cb257-10"></a>  <span class="cf">else</span> <span class="cf">if</span>(trtmt[i]<span class="op">==</span><span class="st">&quot;B&quot;</span>) val[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">4</span>) </span>
<span id="cb257-11"><a href="simulating-data.html#cb257-11"></a>  <span class="cf">else</span> <span class="cf">if</span>(trtmt[i]<span class="op">==</span><span class="st">&quot;C&quot;</span>) val[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">6</span>) </span>
<span id="cb257-12"><a href="simulating-data.html#cb257-12"></a>  <span class="cf">else</span> <span class="cf">if</span>(trtmt[i]<span class="op">==</span><span class="st">&quot;D&quot;</span>) val[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">8</span>) </span>
<span id="cb257-13"><a href="simulating-data.html#cb257-13"></a>  <span class="cf">else</span> <span class="cf">if</span>(trtmt[i]<span class="op">==</span><span class="st">&quot;E&quot;</span>) val[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">10</span>) </span>
<span id="cb257-14"><a href="simulating-data.html#cb257-14"></a>  <span class="cf">else</span> val[i] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dv">60</span>, <span class="dv">12</span>) </span>
<span id="cb257-15"><a href="simulating-data.html#cb257-15"></a>}</span>
<span id="cb257-16"><a href="simulating-data.html#cb257-16"></a>val</span></code></pre></div>
<pre><code>##   [1] 45.992560 48.982344 49.399854 45.516514 10.676699 35.124499 20.265080
##   [8] 47.581770 14.878112 45.413712 11.357480 63.283800  9.883827 28.293539
##  [15] 60.452161 32.656760 56.514417 51.838345 43.936117 30.027446 19.263259
##  [22] 60.464722 63.459196 46.499838 35.106385 67.213020 10.880616 24.836219
##  [29] 62.951318 89.467154 28.839372 10.606887  5.211013 49.459236 64.947507
##  [36] 48.794828 20.073872 46.111825 27.683859 29.258611 20.240426 49.183589
##  [43] 55.414896 46.574597 20.929737 30.073268 50.181540 36.626265 15.108838
##  [50] 47.421117 30.012539 10.100785 38.004888  9.744244 61.651021 75.028867
##  [57] 55.459792 49.772753 15.975207 56.759800 41.536383 78.139842 30.186176
##  [64] 43.845403 34.957620 23.563697 16.424558 45.234899  9.567564 18.155764
##  [71] 55.902732  9.928592 20.463486 17.218049 20.478613 52.111570 61.458349
##  [78] 52.741171 43.880201 64.295319 38.250871 46.807814 37.701207 42.894603
##  [85] 58.527341 51.387697 28.061232 68.022564 47.817200 61.532431 18.916613
##  [92] 20.586886 12.796927 60.817507 67.262284 52.793643 56.362606 10.453136
##  [99] 55.355385 79.775377 55.885538  6.321130 10.455023 34.372688 45.210716
## [106] 24.578482 43.647554 38.997247 40.825033 26.945351 74.393373 54.967133
## [113]  9.087258  6.307758 48.193639 16.632089 34.264439 48.386827 21.224931
## [120] 52.889906  9.821750  8.678911 32.942246 56.441727 47.632831 10.825619
## [127] 15.379115 46.287730 34.448537  9.895360 10.866303 22.072714 45.391778
## [134] 32.606082 44.783565 39.484887  8.706220  7.871810 46.643885 32.989702
## [141]  8.637186 22.168010 19.144363 29.931845 45.358880  8.253083 25.792824
## [148] 27.801426 27.684344 65.556022 55.246059 17.254815 45.860939 24.928664
## [155]  9.881571 11.145898 67.372791 12.729997 30.948257 14.646221 16.711073
## [162] 12.884234 38.626557 54.663416 38.333691 41.236715 32.247244 26.350852
## [169] 24.071387 59.131274  6.512511 11.718129 58.977558 35.766888 30.624316
## [176] 46.158992 25.097236 34.060443 30.777397 67.000129 58.627577 22.697905
## [183] 26.059931 45.623929 46.444505 14.620989 11.054679 26.315198 44.605097
## [190] 57.882760 48.632574 47.737238 15.249730 16.429656  6.217521 54.898402
## [197] 16.285624 27.310308 30.218217 33.461003</code></pre>
<p>A more R-like way would be to take advantage of vectorized functions. First
create a data frame with one row for each group and the mean and standard
deviations we want to use to generate the data for that group.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="simulating-data.html#cb259-1"></a>dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">g=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>],<span class="dt">mean=</span><span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">60</span>,<span class="dv">10</span>),<span class="dt">sd=</span><span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">12</span>,<span class="dv">2</span>))</span>
<span id="cb259-2"><a href="simulating-data.html#cb259-2"></a></span>
<span id="cb259-3"><a href="simulating-data.html#cb259-3"></a>dat</span></code></pre></div>
<pre><code>##   g mean sd
## 1 A   10  2
## 2 B   20  4
## 3 C   30  6
## 4 D   40  8
## 5 E   50 10
## 6 F   60 12</code></pre>
<p>dat is currently a petite little dataframe of 6 rows.</p>
<p>Now sample the row numbers (1 - 6) WITH replacement. We can use these to
randomly sample the data frame rows.</p>
<p>ASIDE: Recall that we can repeatedly call a row or element using subsetting brackets. For example, call the first row of iris 5 times:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="simulating-data.html#cb261-1"></a>iris[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),]</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1            5.1         3.5          1.4         0.2  setosa
## 1.1          5.1         3.5          1.4         0.2  setosa
## 1.2          5.1         3.5          1.4         0.2  setosa
## 1.3          5.1         3.5          1.4         0.2  setosa
## 1.4          5.1         3.5          1.4         0.2  setosa</code></pre>
<p>Let’s exploit that to randomly sample with replacement our data frame of
groups:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="simulating-data.html#cb263-1"></a>n &lt;-<span class="st"> </span><span class="dv">200</span></span>
<span id="cb263-2"><a href="simulating-data.html#cb263-2"></a>k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb263-3"><a href="simulating-data.html#cb263-3"></a>dat &lt;-<span class="st"> </span>dat[k,]</span>
<span id="cb263-4"><a href="simulating-data.html#cb263-4"></a></span>
<span id="cb263-5"><a href="simulating-data.html#cb263-5"></a><span class="kw">str</span>(dat)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:	200 obs. of  3 variables:
##  $ g   : chr  &quot;B&quot; &quot;A&quot; &quot;F&quot; &quot;E&quot; ...
##  $ mean: num  20 10 60 50 10 20 40 20 50 20 ...
##  $ sd  : num  4 2 12 10 2 4 8 4 10 4 ...</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="simulating-data.html#cb265-1"></a><span class="co"># Now generate our data for each group using ONE call to rnorm.</span></span>
<span id="cb265-2"><a href="simulating-data.html#cb265-2"></a>dat<span class="op">$</span>vals &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span>dat<span class="op">$</span>mean, <span class="dt">sd=</span>dat<span class="op">$</span>sd)</span>
<span id="cb265-3"><a href="simulating-data.html#cb265-3"></a><span class="kw">head</span>(dat)</span></code></pre></div>
<pre><code>##     g mean sd      vals
## 2   B   20  4 23.728101
## 1   A   10  2 11.588683
## 6   F   60 12 67.188632
## 5   E   50 10 43.799144
## 1.1 A   10  2  9.971849
## 2.1 B   20  4 19.147462</code></pre>
<p>This is pretty neat. We go from one little dataframe to a larger one in a few lines of code. Mean and SD can be varied by the class, “g” in this case.</p>
</div>
<div id="a-demonstration-of-the-central-limit-theorem" class="section level2">
<h2><span class="header-section-number">11.13</span> A demonstration of the Central Limit Theorem</h2>
<p>The Central Limit Theorem states that the sum of a large number of independent random variables will be approximately normally distributed almost regardless of their individual distributions. We can demonstrate this using various rxxx functions.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="simulating-data.html#cb267-1"></a><span class="co"># sum 6 values from 6 different distributions (sample size = 6)</span></span>
<span id="cb267-2"><a href="simulating-data.html#cb267-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span> <span class="co"># simulate 1000 times</span></span>
<span id="cb267-3"><a href="simulating-data.html#cb267-3"></a>clt  &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rbinom</span>(n,<span class="dv">10</span>,<span class="fl">0.4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df =</span> <span class="dv">6</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb267-4"><a href="simulating-data.html#cb267-4"></a><span class="st">  </span><span class="kw">rnorm</span>(n, <span class="dv">12</span>, <span class="dv">12</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rpois</span>(n, <span class="dt">lambda =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> <span class="dv">7</span>)</span>
<span id="cb267-5"><a href="simulating-data.html#cb267-5"></a><span class="kw">hist</span>(clt, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span>
<span id="cb267-6"><a href="simulating-data.html#cb267-6"></a></span>
<span id="cb267-7"><a href="simulating-data.html#cb267-7"></a><span class="co"># overlay a normal density curve</span></span>
<span id="cb267-8"><a href="simulating-data.html#cb267-8"></a>X &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(clt),<span class="kw">max</span>(clt),<span class="dt">length =</span> <span class="dv">500</span>)       <span class="co"># x</span></span>
<span id="cb267-9"><a href="simulating-data.html#cb267-9"></a>Y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(X, <span class="dt">mean =</span> <span class="kw">mean</span>(clt), <span class="dt">sd =</span> <span class="kw">sd</span>(clt))  <span class="co"># f(x) = dnorm</span></span>
<span id="cb267-10"><a href="simulating-data.html#cb267-10"></a><span class="kw">lines</span>(X,Y,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>) <span class="co"># plot (x,y) coordinates as a &quot;blue&quot; line (&quot;l&quot;)</span></span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="simulating-data.html#cb268-1"></a><span class="kw">rm</span>(X, Y, clt)</span></code></pre></div>
<p>Let’s unpack some of this:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="simulating-data.html#cb269-1"></a>clt1  &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span>)</span>
<span id="cb269-2"><a href="simulating-data.html#cb269-2"></a><span class="kw">hist</span>(clt1, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="simulating-data.html#cb270-1"></a>clt2  &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n,<span class="dv">10</span>,<span class="fl">0.4</span>)</span>
<span id="cb270-2"><a href="simulating-data.html#cb270-2"></a><span class="kw">hist</span>(clt2, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-2.png" width="672" /></p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="simulating-data.html#cb271-1"></a>clt3  &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df =</span> <span class="dv">6</span>)</span>
<span id="cb271-2"><a href="simulating-data.html#cb271-2"></a><span class="kw">hist</span>(clt3, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-3.png" width="672" /></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="simulating-data.html#cb272-1"></a>clt4  &lt;-<span class="kw">rnorm</span>(n, <span class="dv">12</span>, <span class="dv">12</span>) </span>
<span id="cb272-2"><a href="simulating-data.html#cb272-2"></a><span class="kw">hist</span>(clt4, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-4.png" width="672" /></p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="simulating-data.html#cb273-1"></a>clt5  &lt;-<span class="st"> </span><span class="kw">rpois</span>(n, <span class="dt">lambda =</span> <span class="dv">3</span>)</span>
<span id="cb273-2"><a href="simulating-data.html#cb273-2"></a><span class="kw">hist</span>(clt5, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-5.png" width="672" /></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="simulating-data.html#cb274-1"></a>clt6  &lt;-<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> <span class="dv">7</span>)</span>
<span id="cb274-2"><a href="simulating-data.html#cb274-2"></a><span class="kw">hist</span>(clt6, <span class="dt">freq=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-6.png" width="672" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="simulating-data.html#cb275-1"></a><span class="co"># All of this base R graphing is clunky and doesn&#39;t lend itself to modification as well as ggplot() figures.</span></span>
<span id="cb275-2"><a href="simulating-data.html#cb275-2"></a></span>
<span id="cb275-3"><a href="simulating-data.html#cb275-3"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb275-4"><a href="simulating-data.html#cb275-4"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(clt1, clt2, clt3, clt4, clt5, clt6)</span>
<span id="cb275-5"><a href="simulating-data.html#cb275-5"></a></span>
<span id="cb275-6"><a href="simulating-data.html#cb275-6"></a>df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(clt3)) <span class="op">+</span></span>
<span id="cb275-7"><a href="simulating-data.html#cb275-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">30</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-7.png" width="672" /></p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="simulating-data.html#cb276-1"></a>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb276-2"><a href="simulating-data.html#cb276-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(clt3)) <span class="op">+</span></span>
<span id="cb276-3"><a href="simulating-data.html#cb276-3"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-54-8.png" width="672" /></p>
</div>
<div id="overlaying-normal-curve-on-histogram" class="section level2">
<h2><span class="header-section-number">11.14</span> Overlaying normal curve on histogram</h2>
<p>The following solution was on StackOverflow at <a href="https://stackoverflow.com/questions/6967664/ggplot2-histogram-with-normal-curve" class="uri">https://stackoverflow.com/questions/6967664/ggplot2-histogram-with-normal-curve</a></p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="simulating-data.html#cb277-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb277-2"><a href="simulating-data.html#cb277-2"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">PF =</span> <span class="dv">10</span><span class="op">*</span><span class="kw">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb277-3"><a href="simulating-data.html#cb277-3"></a><span class="kw">ggplot</span>(df1, <span class="kw">aes</span>(<span class="dt">x =</span> PF)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb277-4"><a href="simulating-data.html#cb277-4"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span>..density..),</span>
<span id="cb277-5"><a href="simulating-data.html#cb277-5"></a>                   <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">40</span>, <span class="dv">40</span>, <span class="dt">by =</span> <span class="dv">5</span>), </span>
<span id="cb277-6"><a href="simulating-data.html#cb277-6"></a>                   <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb277-7"><a href="simulating-data.html#cb277-7"></a>                   <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb277-8"><a href="simulating-data.html#cb277-8"></a><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(df1<span class="op">$</span>PF), <span class="dt">sd =</span> <span class="kw">sd</span>(df1<span class="op">$</span>PF)), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) </span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>From the {ggplot2} help: “This stat makes it easy to superimpose a function on top of an existing plot. The function is called with a grid of evenly spaced values along the x axis, and the results are drawn (by default) with a line.”</p>
<p>Note how stat_function() lends itself to quick addition: simply feed the correct fun and args to the function.</p>
<p>Now accomplish this for clt3</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="simulating-data.html#cb278-1"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clt3)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb278-2"><a href="simulating-data.html#cb278-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span>..density..),</span>
<span id="cb278-3"><a href="simulating-data.html#cb278-3"></a>                   <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dt">by =</span> <span class="dv">1</span>), </span>
<span id="cb278-4"><a href="simulating-data.html#cb278-4"></a>                   <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb278-5"><a href="simulating-data.html#cb278-5"></a>                   <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb278-6"><a href="simulating-data.html#cb278-6"></a><span class="kw">stat_function</span>(<span class="dt">fun =</span> dchisq, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df =</span> <span class="dv">6</span>), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb278-7"><a href="simulating-data.html#cb278-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;chi-squared distribution&quot;</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>Note how the args in dchisq includes only the df = 6. No mean needs to be calculated (as in dnorm).</p>
<p>Now accomplish this for clt1</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="simulating-data.html#cb279-1"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> clt1)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-2"><a href="simulating-data.html#cb279-2"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span>..density..),</span>
<span id="cb279-3"><a href="simulating-data.html#cb279-3"></a>                   <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dt">by =</span> <span class="fl">.5</span>), </span>
<span id="cb279-4"><a href="simulating-data.html#cb279-4"></a>                   <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb279-5"><a href="simulating-data.html#cb279-5"></a>                   <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb279-6"><a href="simulating-data.html#cb279-6"></a><span class="kw">stat_function</span>(<span class="dt">fun =</span> dexp, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">rate =</span> <span class="dv">1</span>), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-7"><a href="simulating-data.html#cb279-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;exponential distribution&quot;</span>)</span></code></pre></div>
<p><img src="test-book_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="subset.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/10SimulatingData.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["test-book.pdf", "test-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

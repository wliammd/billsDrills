# Dimensionality Reduction {#dimensionalityreduction}

```{r}
library(tidyverse)
library(plotly)
```

## Experiment in showing dimensionality reduction for pathologists

The first step is to build three separate "clouds" of data that do not overlap in three dimensions, but which do overlap in two dimensions. 

```{r}
df <- tibble(
  diagnostic_class = rep("A", 100),
  x = rnorm(100, mean = 1, sd = 0.1), 
  y = rnorm(100, mean = 1, sd = 0.1), 
  z = rnorm(100, mean = 1, sd = 0.1)
)

df1 <- tibble(
  diagnostic_class = rep("B", 100),
  x = rnorm(100, mean = 1, sd = 0.1), 
  y = rnorm(100, mean = 2, sd = 0.1), 
  z = rnorm(100, mean = 1, sd = 0.1)
)

df2 <- tibble(
  diagnostic_class = rep("C", 100),
  x = rnorm(100, mean = 1, sd = 0.1), 
  y = rnorm(100, mean = 1, sd = 0.1), 
  z = rnorm(100, mean = 2, sd = 0.1)
)

df <- df %>% rbind(df1) %>% rbind(df2)
```

The following 2D and 3D plots make it clear that the diagnostic class is only obvious when one takes into account the z-axis. 

```{r}
df %>% ggplot(aes(x,y, color = diagnostic_class)) + geom_point()

plot_ly(x=df$x, y=df$y, z=df$z, type="scatter3d", mode="markers", color = df$diagnostic_class)
```

### Principle component analysis

```{r}
library(ggfortify)
autoplot(prcomp(df[,2:4]), data = df, colour = 'diagnostic_class', size = 8)
```

### t-distributed stochastic neighbor embedding

```{r}
library(Rtsne)

df_unique <- unique(df) #removes duplicates
df_matrix <- as.matrix(df[,2:4])
set.seed(2020)
tsne_out <- Rtsne(df_matrix)

tsne_plot <- data.frame(x = tsne_out$Y[,1], y = tsne_out$Y[,2], col = df$diagnostic_class)
ggplot(tsne_plot) + geom_point(aes(x=x, y=y, color=col))

```

